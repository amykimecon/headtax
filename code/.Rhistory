#geom_errorbar(mapping = aes(ymin = height10, ymax = height90)) +
theme_minimal() + theme(legend.position='bottom') +
labs(x = "Year of Immigration", y = "Whipple Index of Chinese Imm.", size = "", color = "", shape = "") +
theme(text = element_text(size=18), axis.text = element_text(size = 14))
ggsave(glue("{git}/output/slides/whipple_compare_selection_all.png"), fig_whipple_compare_slides, height = 5, width = 8)
did_data <- can_imm %>% filter(YEAR >= 1901 & YRIMM >= 1880 )%>% #& YRIMM <= 1913) %>% #only keeping years with earnings/yrimm data
mutate(LABOR = ifelse(OCC1950 %in% c(970, 650, 820, 830), 1, 0), #labor: includes general laborer, mine laborer, farm laborer
BORNCHI = ifelse(BPL == "China", 1, 0),
BORNCHI_tax50 = BORNCHI*ifelse(tax == 1496.19, 1, 0),
BORNCHI_tax100 = BORNCHI*ifelse(tax == 2992.61, 1, 0),
BORNCHI_tax500 = BORNCHI*ifelse(tax == 14115.70, 1, 0),
BORNCHI_notax = BORNCHI * ifelse(tax == 0, 1, 0),
AGEATIMM = AGE - (YEAR - YRIMM),
ageheap = ifelse(AGE %% 5 == 0, 1, 0),
twoyearpost = case_when(YRIMM %in% c(1886, 1887) ~ "_post50",
YRIMM %in% c(1901,1902) ~ "post100",
YRIMM %in% c(1904,1905) ~ "post500",
TRUE ~ "_notpost"),
oneyearpost = case_when(YRIMM == 1886 ~ "_post50",
YRIMM == 1901 ~ "post100",
YRIMM == 1904 ~ "post500",
TRUE ~ "_notpost"),
BORNCHI_twoyearpost50 = BORNCHI*ifelse(twoyearpost == "_post50", 1, 0),
BORNCHI_twoyearpost100 = BORNCHI*ifelse(twoyearpost == "post100", 1, 0),
BORNCHI_twoyearpost500 = BORNCHI*ifelse(twoyearpost == "post500", 1, 0))
did_data_japan <- did_data %>% filter(BORNCHI == 1 | BPL == "Japan") %>% filter(YRIMM >= 1890 & YRIMM <= 1907)# & YEAR != 1921)
did_reg_labor <- lm(LABOR ~ factor(YRIMM) + factor(YEAR) + AGE + + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data %>% filter(MALE == 1 & AGE >= 18), weights = WEIGHT)
summary(did_reg_labor)
%>% filter(OCC1950 != 290 & OCC1950 != 983)
did_reg_labor <- lm(LABOR ~ factor(YRIMM) + factor(YEAR) + AGE + + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data %>% filter(MALE == 1 & AGE >= 18) %>% filter(OCC1950 != 290 & OCC1950 != 983), weights = WEIGHT)
%>% filter(OCC1950 != 290 & OCC1950 != 983)
summary(did_reg_labor)
did_reg_labor <- lm(LABOR ~ factor(YRIMM) + factor(YEAR) + AGE + + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data %>% filter(MALE == 1 & AGE >= 18), #%>% filter(OCC1950 != 290 & OCC1950 != 983),
weights = WEIGHT)
did_reg_speakeng <- lm(SPEAKENG ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data %>% filter(AGE >= 6) %>% filter(MALE == 1 & AGE > 23 & !(OCC1950 %in% c(290, 983))),
weights = WEIGHT)
summary(did_reg_speakeng)
did_reg_speakeng <- lm(SPEAKENG ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data %>% filter(AGE >= 6)),
did_reg_speakeng <- lm(SPEAKENG ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data %>% filter(AGE >= 6),
weights = WEIGHT)
summary(did_reg_speakeng)
did_reg_speakeng <- lm(SPEAKENG ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data %>% filter(AGE >= 6 & MALE == 1),
weights = WEIGHT)
summary(did_reg_speakeng)
did_reg_speakeng <- lm(SPEAKENG ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data %>% filter(AGE >= 6 & MALE == 1 & OCC1950 != 290 & OCC1950 != 98),
weights = WEIGHT)
summary(did_reg_speakeng)
did_reg_speakeng <- lm(SPEAKENG ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data %>% filter(AGE >= 6 & MALE == 1),
weights = WEIGHT)
did_reg_canread <- lm(CANREAD ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data %>% filter(AGE >= 18 & MALE == 1), weights = WEIGHT)
summary(did_reg_canread)
did_reg_whipple <- lm(WHIPPLE ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data %>% filter(MALE == 1 & AGE >= 23 & AGE <= 52), weights = WEIGHT)
summary(did_reg_whipple)
did_reg_earn <- lm(EARN ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data %>% filter(MALE == 1 & AGE >= 18), weights = WEIGHT)
summary(did_reg_earn)
stargazer(did_reg_labor, did_reg_canread, did_reg_speakeng, did_reg_whipple, did_reg_earn,
out = glue("{git}/output/slides/selection_all.tex"), float = FALSE,
intercept.bottom = FALSE,
single.row = TRUE,
dep.var.labels = c("$\\mathbb{P}[\\text{Laborer}]$","$\\mathbb{P}[\\text{Literate}]$",
"$\\mathbb{P}[\\text{Speaks English}]$", "Whipple", "Earning"),
keep = c("BORNCHI*"),
covariate.labels = c("$\\hat{\\beta}_{1}$ (Born in China)",
"$\\hat{\\gamma}_{50}^{DD}$ ($C_i \\times$ \\$50 Tax)",
"$\\hat{\\gamma}_{100}^{DD}$ ($C_i \\times$ \\$100 Tax)",
"$\\hat{\\gamma}_{500}^{DD}$ ($C_i \\times$ \\$500 Tax)"),
keep.stat=c("n","adj.rsq"),
table.layout = "d-t-as",
add.lines = list(c("Dep. Var. Mean (Chinese)", formatC(did_data_means_chi, format = "f"))))
did_reg_labor <- lm(LABOR ~ factor(YRIMM) + factor(YEAR) + AGE + + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data %>% filter(MALE == 1 & AGE >= 18), #%>% filter(OCC1950 != 290 & OCC1950 != 983),
weights = WEIGHT)
did_reg_speakeng <- lm(SPEAKENG ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data %>% filter(AGE >= 6 & MALE == 1),
weights = WEIGHT)
did_reg_canread <- lm(CANREAD ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data %>% filter(AGE >= 18 & MALE == 1), weights = WEIGHT)
did_reg_whipple <- lm(WHIPPLE ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data %>% filter(MALE == 1 & AGE >= 23 & AGE <= 52), weights = WEIGHT)
did_reg_earn <- lm(EARN ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data %>% filter(MALE == 1 & AGE >= 18), weights = WEIGHT)
stargazer(did_reg_labor, did_reg_canread, did_reg_speakeng, did_reg_whipple, did_reg_earn,
out = glue("{git}/output/slides/selection_all.tex"), float = FALSE,
intercept.bottom = FALSE,
single.row = TRUE,
dep.var.labels = c("$\\mathbb{P}[\\text{Laborer}]$","$\\mathbb{P}[\\text{Literate}]$",
"$\\mathbb{P}[\\text{Speaks English}]$", "Whipple", "Earning"),
keep = c("BORNCHI*"),
covariate.labels = c("$\\hat{\\beta}_{1}$ (Born in China)",
"$\\hat{\\gamma}_{50}^{DD}$ ($C_i \\times$ \\$50 Tax)",
"$\\hat{\\gamma}_{100}^{DD}$ ($C_i \\times$ \\$100 Tax)",
"$\\hat{\\gamma}_{500}^{DD}$ ($C_i \\times$ \\$500 Tax)"),
keep.stat=c("n","adj.rsq"),
table.layout = "d-t-as",
add.lines = list(c("Dep. Var. Mean (Chinese)", formatC(did_data_means_chi, format = "f"))))
stargazer(did_reg_labor, did_reg_canread, did_reg_speakeng, did_reg_whipple, did_reg_earn)
summary(did_reg_labor)
summary(did_reg_canread)
summary(did_reg_speakeng)
summary(did_reg_whipple)
summary(did_reg_earn)
stargazer(did_reg_labor, did_reg_canread, did_reg_speakeng, did_reg_whipple, did_reg_earn)
# normal regs
didlab <- lm(LABOR ~ factor(YRIMM) + factor(YEAR) + AGE + + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data %>% filter(MALE == 1 & AGE >= 18), #%>% filter(OCC1950 != 290 & OCC1950 != 983),
weights = WEIGHT)
dideng <- lm(SPEAKENG ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data %>% filter(AGE >= 6 & MALE == 1),
weights = WEIGHT)
didread <- lm(CANREAD ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data %>% filter(AGE >= 18 & MALE == 1), weights = WEIGHT)
didwhip <- lm(WHIPPLE ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data %>% filter(MALE == 1 & AGE >= 23 & AGE <= 52), weights = WEIGHT)
didearn <- lm(EARN ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data %>% filter(MALE == 1 & AGE >= 18), weights = WEIGHT)
stargazer(didlab, didread, dideng, didwhip, didearn)
stargazer(didlab, didread, dideng, didwhip, didearn,
out = glue("{git}/output/slides/selection_all.tex"), float = FALSE,
intercept.bottom = FALSE,
single.row = TRUE,
dep.var.labels = c("$\\mathbb{P}[\\text{Laborer}]$","$\\mathbb{P}[\\text{Literate}]$",
"$\\mathbb{P}[\\text{Speaks English}]$", "Whipple", "Earning"),
keep = c("BORNCHI*"),
covariate.labels = c("$\\hat{\\beta}_{1}$ (Born in China)",
"$\\hat{\\gamma}_{50}^{DD}$ ($C_i \\times$ \\$50 Tax)",
"$\\hat{\\gamma}_{100}^{DD}$ ($C_i \\times$ \\$100 Tax)",
"$\\hat{\\gamma}_{500}^{DD}$ ($C_i \\times$ \\$500 Tax)"),
keep.stat=c("n","adj.rsq"),
table.layout = "d-t-as",
add.lines = list(c("Dep. Var. Mean (Chinese)", formatC(did_data_means_chi, format = "f"))))
stargazer(didlab, didread, dideng, didwhip, didearn,
out = glue("{git}/output/slides/selection_all.tex"), float = FALSE,
intercept.bottom = FALSE,
single.row = TRUE,
dep.var.labels = c("$\\mathbb{P}[\\text{Laborer}]$","$\\mathbb{P}[\\text{Literate}]$",
"$\\mathbb{P}[\\text{Speaks English}]$", "Whipple", "Earning"),
keep = c("BORNCHI*"),
covariate.labels = c("$\\hat{\\beta}_{1}$ (Born in China)",
"$\\hat{\\gamma}_{50}^{DD}$ ($C_i \\times$ \\$50 Tax)",
"$\\hat{\\gamma}_{100}^{DD}$ ($C_i \\times$ \\$100 Tax)",
"$\\hat{\\gamma}_{500}^{DD}$ ($C_i \\times$ \\$500 Tax)"),
keep.stat=c("n","adj.rsq"),
table.layout = "d-t-as")#
didjlab <- lm(LABOR ~ factor(YRIMM) + factor(YEAR) + AGE + + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data_japan %>% filter(MALE == 1 & AGE >= 18), #%>% filter(OCC1950 != 290 & OCC1950 != 983),
weights = WEIGHT)
didjeng <- lm(SPEAKENG ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data_japan %>% filter(AGE >= 6 & MALE == 1),
weights = WEIGHT)
didjread <- lm(CANREAD ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data_japan %>% filter(AGE >= 18 & MALE == 1), weights = WEIGHT)
didjwhip <- lm(WHIPPLE ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data_japan %>% filter(MALE == 1 & AGE >= 23 & AGE <= 52), weights = WEIGHT)
didjearn <- lm(EARN ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data_japan %>% filter(MALE == 1 & AGE >= 18), weights = WEIGHT)
stargazer(didjlab, didjread, didjeng, didjwhip, didjearn,
out = glue("{git}/output/slides/selection_japan.tex"), float = FALSE,
intercept.bottom = FALSE,
single.row = TRUE,
dep.var.labels = c("$\\mathbb{P}[\\text{Laborer}]$","$\\mathbb{P}[\\text{Literate}]$",
"$\\mathbb{P}[\\text{Speaks English}]$", "Whipple", "Earning"),
keep = c("BORNCHI*"),
covariate.labels = c("$\\hat{\\beta}_{1}$ (Born in China)",
"$\\hat{\\gamma}_{50}^{DD}$ ($C_i \\times$ \\$50 Tax)",
"$\\hat{\\gamma}_{100}^{DD}$ ($C_i \\times$ \\$100 Tax)",
"$\\hat{\\gamma}_{500}^{DD}$ ($C_i \\times$ \\$500 Tax)"),
keep.stat=c("n","adj.rsq"),
table.layout = "d-t-as")#,
#          add.lines = list(c("Dep. Var. Mean (Chinese)", formatC(did_data_means_chi, format = "f"))))
# slides: all immig
stargazer(didlab, didread, dideng, didwhip, didearn,
out = glue("{git}/output/slides/selection_all.tex"), float = FALSE,
intercept.bottom = FALSE,
single.row = TRUE,
dep.var.labels = c("$\\mathbb{P}[\\text{Laborer}]$","$\\mathbb{P}[\\text{Literate}]$",
"$\\mathbb{P}[\\text{Speaks English}]$", "Age Heaping", "Earning"),
keep = c("BORNCHI*"),
covariate.labels = c("$\\hat{\\beta}_{1}$ (Born in China)",
"$\\hat{\\gamma}_{50}^{DD}$ ($C_i \\times$ \\$50 Tax)",
"$\\hat{\\gamma}_{100}^{DD}$ ($C_i \\times$ \\$100 Tax)",
"$\\hat{\\gamma}_{500}^{DD}$ ($C_i \\times$ \\$500 Tax)"),
keep.stat=c("n","adj.rsq"),
table.layout = "d-t-as")#,
#          add.lines = list(c("Dep. Var. Mean (Chinese)", formatC(did_data_means_chi, format = "f"))))
#slides: japanese immig
stargazer(didjlab, didjread, didjeng, didjwhip, didjearn,
out = glue("{git}/output/slides/selection_japan.tex"), float = FALSE,
intercept.bottom = FALSE,
single.row = TRUE,
dep.var.labels = c("$\\mathbb{P}[\\text{Laborer}]$","$\\mathbb{P}[\\text{Literate}]$",
"$\\mathbb{P}[\\text{Speaks English}]$", "Age Heaping", "Earning"),
keep = c("BORNCHI*"),
covariate.labels = c("$\\hat{\\beta}_{1}$ (Born in China)",
"$\\hat{\\gamma}_{100}^{DD}$ ($C_i \\times$ \\$100 Tax)",
"$\\hat{\\gamma}_{500}^{DD}$ ($C_i \\times$ \\$500 Tax)"),
keep.stat=c("n","adj.rsq"),
table.layout = "d-t-as")#,
#          add.lines = list(c("Dep. Var. Mean (Chinese)", formatC(did_data_means_chi, format = "f"))))
stargazer(didjlab, didjread, didjeng, didjwhip, didjearn)
didjlab <- lm(LABOR ~ factor(YRIMM) + factor(YEAR) + AGE + + BORNCHI + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data_japan %>% filter(MALE == 1 & AGE >= 18), #%>% filter(OCC1950 != 290 & OCC1950 != 983),
weights = WEIGHT)
didjeng <- lm(SPEAKENG ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data_japan %>% filter(AGE >= 6 & MALE == 1),
weights = WEIGHT)
didjread <- lm(CANREAD ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data_japan %>% filter(AGE >= 18 & MALE == 1), weights = WEIGHT)
didjwhip <- lm(WHIPPLE ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data_japan %>% filter(MALE == 1 & AGE >= 23 & AGE <= 52), weights = WEIGHT)
didjearn <- lm(EARN ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data_japan %>% filter(MALE == 1 & AGE >= 18), weights = WEIGHT)
did_data <- can_imm %>% filter(YEAR >= 1901 & YRIMM >= 1880 & YRIMM <= 1913) %>% #only keeping years with earnings/yrimm data
mutate(LABOR = ifelse(OCC1950 %in% c(970, 650, 820, 830), 1, 0), #labor: includes general laborer, mine laborer, farm laborer
BORNCHI = ifelse(BPL == "China", 1, 0),
BORNCHI_tax50 = BORNCHI*ifelse(tax == 1496.19, 1, 0),
BORNCHI_tax100 = BORNCHI*ifelse(tax == 2992.61, 1, 0),
BORNCHI_tax500 = BORNCHI*ifelse(tax == 14115.70, 1, 0),
BORNCHI_notax = BORNCHI * ifelse(tax == 0, 1, 0),
AGEATIMM = AGE - (YEAR - YRIMM),
ageheap = ifelse(AGE %% 5 == 0, 1, 0),
twoyearpost = case_when(YRIMM %in% c(1886, 1887) ~ "_post50",
YRIMM %in% c(1901,1902) ~ "post100",
YRIMM %in% c(1904,1905) ~ "post500",
TRUE ~ "_notpost"),
oneyearpost = case_when(YRIMM == 1886 ~ "_post50",
YRIMM == 1901 ~ "post100",
YRIMM == 1904 ~ "post500",
TRUE ~ "_notpost"),
BORNCHI_twoyearpost50 = BORNCHI*ifelse(twoyearpost == "_post50", 1, 0),
BORNCHI_twoyearpost100 = BORNCHI*ifelse(twoyearpost == "post100", 1, 0),
BORNCHI_twoyearpost500 = BORNCHI*ifelse(twoyearpost == "post500", 1, 0))
did_data_japan <- did_data %>% filter(BORNCHI == 1 | BPL == "Japan") %>% filter(YRIMM >= 1890 & YRIMM <= 1907)# & YEAR != 1921)
# # test
# test <- did_data %>% group_by(BORNCHI, YRIMM) %>%
#   summarize(n = sum(WEIGHT),
#             across(c(LABOR, SPEAKENG, CANREAD, EARN, EMPLOYED, EMPLOYEE), function(.x) weighted.mean(.x, WEIGHT, na.rm=TRUE)))
#
# ggplot(test, aes(x = YRIMM, y = LABOR, color = factor(BORNCHI), size = n))+ geom_point()
# ggplot(test, aes(x = YRIMM, y = SPEAKENG, color = factor(BORNCHI), size = n))+ geom_point()
# ggplot(test, aes(x = YRIMM, y = CANREAD, color = factor(BORNCHI), size = n))+ geom_point()
# ggplot(test, aes(x = YRIMM, y = EARN, color = factor(BORNCHI), size = n))+ geom_point()
# ggplot(test, aes(x = YRIMM, y = EMPLOYED, color = factor(BORNCHI), size = n))+ geom_point()
# ggplot(test, aes(x = YRIMM, y = EMPLOYEE, color = factor(BORNCHI), size = n))+ geom_point()
# normal regs
didlab <- lm(LABOR ~ factor(YRIMM) + factor(YEAR) + AGE + + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data %>% filter(MALE == 1 & AGE >= 18), #%>% filter(OCC1950 != 290 & OCC1950 != 983),
weights = WEIGHT)
dideng <- lm(SPEAKENG ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data %>% filter(AGE >= 6 & MALE == 1),
weights = WEIGHT)
didread <- lm(CANREAD ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data %>% filter(AGE >= 18 & MALE == 1), weights = WEIGHT)
didwhip <- lm(WHIPPLE ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data %>% filter(MALE == 1 & AGE >= 23 & AGE <= 52), weights = WEIGHT)
didearn <- lm(EARN ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data %>% filter(MALE == 1 & AGE >= 18), weights = WEIGHT)
# japan
didjlab <- lm(LABOR ~ factor(YRIMM) + factor(YEAR) + AGE + + BORNCHI + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data_japan %>% filter(MALE == 1 & AGE >= 18), #%>% filter(OCC1950 != 290 & OCC1950 != 983),
weights = WEIGHT)
didjeng <- lm(SPEAKENG ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data_japan %>% filter(AGE >= 6 & MALE == 1),
weights = WEIGHT)
didjread <- lm(CANREAD ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data_japan %>% filter(AGE >= 18 & MALE == 1), weights = WEIGHT)
didjwhip <- lm(WHIPPLE ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data_japan %>% filter(MALE == 1 & AGE >= 23 & AGE <= 52), weights = WEIGHT)
didjearn <- lm(EARN ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data_japan %>% filter(MALE == 1 & AGE >= 18), weights = WEIGHT)
# summary(lm(SPEAKENG ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
#            data = did_data %>% filter(MALE == 1 & AGE > 23 & !(OCC1950 %in% c(290, 983))), weights = WEIGHT))
# summary(lm(SPEAKENG ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax100 + BORNCHI_tax500,
#            data = did_data_japan %>% filter(MALE == 1 & AGE > 23 & !(OCC1950 %in% c(290, 983))), weights = WEIGHT))
#
# summary(lm(CANREAD ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
#            data = did_data %>% filter(MALE == 1), weights = WEIGHT))
# summary(lm(CANREAD ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax100 + BORNCHI_tax500,
#            data = did_data_japan %>% filter(MALE == 1), weights = WEIGHT))
#
# summary(lm(WHIPPLE ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
#            data = did_data %>% filter(MALE == 1 & AGE >= 23 & AGE <= 52), weights = WEIGHT))
# summary(lm(WHIPPLE ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax100 + BORNCHI_tax500,
#            data = did_data_japan %>% filter(MALE == 1 & AGE >= 23 & AGE <= 52), weights = WEIGHT))
#
#
# did_reg_canread <- lm(CANREAD ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
#                       data = did_data, weights = WEIGHT)
# did_reg_earn <- lm(EARN ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
#                    data = did_data, weights = WEIGHT)
# did_reg_houseown <- lm(HOUSEOWN ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
#                        data = did_data, weights = WEIGHT)
#
# # regs w/ two year post
# did_reg_labor <- lm(LABOR ~ factor(YRIMM) + factor(YEAR) + AGE + + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500 +
#                       BORNCHI_twoyearpost50 + BORNCHI_twoyearpost100 + BORNCHI_twoyearpost500,
#                     data = did_data, weights = WEIGHT)
# did_reg_canread <- lm(CANREAD ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500+
#                         BORNCHI_twoyearpost50 + BORNCHI_twoyearpost100 + BORNCHI_twoyearpost500,
#                       data = did_data, weights = WEIGHT)
# did_reg_earn <- lm(EARN ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500+
#                      BORNCHI_twoyearpost50 + BORNCHI_twoyearpost100 + BORNCHI_twoyearpost500,
#                    data = did_data, weights = WEIGHT)
# did_reg_houseown <- lm(HOUSEOWN ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500+
#                          BORNCHI_twoyearpost50 + BORNCHI_twoyearpost100 + BORNCHI_twoyearpost500,
#                        data = did_data, weights = WEIGHT)
did_data_means_chi <- c(weighted.mean(filter(did_data, !is.na(LABOR) & BORNCHI == 1 & MALE == 1 & AGE >= 18)$LABOR,
ilter(did_data, !is.na(LABOR) & BORNCHI == 1 & MALE == 1 & AGE >= 18)$WEIGHT),
weighted.mean(filter(did_data, !is.na(CANREAD) & BORNCHI == 1 & MALE == 1 & AGE >= 18)$CANREAD,
filter(did_data, !is.na(CANREAD) & BORNCHI == 1 & MALE == 1 & AGE >= 18)$WEIGHT),
weighted.mean(filter(did_data, !is.na(SPEAKENG) & BORNCHI == 1 & MALE == 1 & AGE >= 6)$SPEAKENG,
filter(did_data, !is.na(SPEAKENG) & BORNCHI == 1 & MALE == 1 & AGE >= 6)$WEIGHT),
weighted.mean(filter(did_data, !is.na(WHIPPLE) & BORNCHI == 1 & MALE == 1 & AGE >= 23 & AGE <= 52)$WHIPPLE,
filter(did_data, !is.na(WHIPPLE) & BORNCHI == 1 & MALE == 1 & AGE >= 23 & AGE <= 52)$WEIGHT),
weighted.mean(filter(did_data, !is.na(EARN) & BORNCHI == 1 & MALE == 1 & AGE >= 18)$EARN,
filter(did_data, !is.na(EARN) & BORNCHI == 1 & MALE == 1 & AGE >= 18)$WEIGHT)
)
did_data_means_chi <- c(weighted.mean(filter(did_data, !is.na(LABOR) & BORNCHI == 1 & MALE == 1 & AGE >= 18)$LABOR,
filter(did_data, !is.na(LABOR) & BORNCHI == 1 & MALE == 1 & AGE >= 18)$WEIGHT),
weighted.mean(filter(did_data, !is.na(CANREAD) & BORNCHI == 1 & MALE == 1 & AGE >= 18)$CANREAD,
filter(did_data, !is.na(CANREAD) & BORNCHI == 1 & MALE == 1 & AGE >= 18)$WEIGHT),
weighted.mean(filter(did_data, !is.na(SPEAKENG) & BORNCHI == 1 & MALE == 1 & AGE >= 6)$SPEAKENG,
filter(did_data, !is.na(SPEAKENG) & BORNCHI == 1 & MALE == 1 & AGE >= 6)$WEIGHT),
weighted.mean(filter(did_data, !is.na(WHIPPLE) & BORNCHI == 1 & MALE == 1 & AGE >= 23 & AGE <= 52)$WHIPPLE,
filter(did_data, !is.na(WHIPPLE) & BORNCHI == 1 & MALE == 1 & AGE >= 23 & AGE <= 52)$WEIGHT),
weighted.mean(filter(did_data, !is.na(EARN) & BORNCHI == 1 & MALE == 1 & AGE >= 18)$EARN,
filter(did_data, !is.na(EARN) & BORNCHI == 1 & MALE == 1 & AGE >= 18)$WEIGHT)
)
stargazer(didlab, didread, dideng, didwhip, didearn,
out = glue("{git}/output/slides/selection_all.tex"), float = FALSE,
intercept.bottom = FALSE,
single.row = TRUE,
dep.var.labels = c("$\\mathbb{P}[\\text{Laborer}]$","$\\mathbb{P}[\\text{Literate}]$",
"$\\mathbb{P}[\\text{Speaks English}]$", "Age Heaping", "Earnings"),
keep = c("BORNCHI*"),
covariate.labels = c("$\\hat{\\beta}_{1}$ (Born in China)",
"$\\hat{\\gamma}_{50}^{DD}$ ($C_i \\times$ \\$50 Tax)",
"$\\hat{\\gamma}_{100}^{DD}$ ($C_i \\times$ \\$100 Tax)",
"$\\hat{\\gamma}_{500}^{DD}$ ($C_i \\times$ \\$500 Tax)"),
keep.stat=c("n","adj.rsq"),
table.layout = "d-t-as"),
stargazer(didlab, didread, dideng, didwhip, didearn,
out = glue("{git}/output/slides/selection_all.tex"), float = FALSE,
intercept.bottom = FALSE,
single.row = TRUE,
dep.var.labels = c("$\\mathbb{P}[\\text{Laborer}]$","$\\mathbb{P}[\\text{Literate}]$",
"$\\mathbb{P}[\\text{Speaks English}]$", "Age Heaping", "Earnings"),
keep = c("BORNCHI*"),
covariate.labels = c("$\\hat{\\beta}_{1}$ (Born in China)",
"$\\hat{\\gamma}_{50}^{DD}$ ($C_i \\times$ \\$50 Tax)",
"$\\hat{\\gamma}_{100}^{DD}$ ($C_i \\times$ \\$100 Tax)",
"$\\hat{\\gamma}_{500}^{DD}$ ($C_i \\times$ \\$500 Tax)"),
keep.stat=c("n","adj.rsq"),
table.layout = "d-t-as",
add.lines = list(c("Dep. Var. Mean (Chinese)", formatC(did_data_means_chi, format = "f"))))
stargazer(didjlab, didjread, didjeng, didjwhip, didjearn,
out = glue("{git}/output/slides/selection_japan.tex"), float = FALSE,
intercept.bottom = FALSE,
single.row = TRUE,
dep.var.labels = c("$\\mathbb{P}[\\text{Laborer}]$","$\\mathbb{P}[\\text{Literate}]$",
"$\\mathbb{P}[\\text{Speaks English}]$", "Age Heaping", "Earnings"),
keep = c("BORNCHI*"),
covariate.labels = c("$\\hat{\\beta}_{1}$ (Born in China)",
"$\\hat{\\gamma}_{100}^{DD}$ ($C_i \\times$ \\$100 Tax)",
"$\\hat{\\gamma}_{500}^{DD}$ ($C_i \\times$ \\$500 Tax)"),
keep.stat=c("n","adj.rsq"),
table.layout = "d-t-as",
add.lines = list(c("Dep. Var. Mean (Chinese)", formatC(did_data_means_chi, format = "f"))))
did_data <- can_imm %>% filter(YEAR >= 1901 & YRIMM >= 1882 & YRIMM <= 1913) %>% #only keeping years with earnings/yrimm data
mutate(LABOR = ifelse(OCC1950 %in% c(970, 650, 820, 830), 1, 0), #labor: includes general laborer, mine laborer, farm laborer
BORNCHI = ifelse(BPL == "China", 1, 0),
BORNCHI_tax50 = BORNCHI*ifelse(tax == 1496.19, 1, 0),
BORNCHI_tax100 = BORNCHI*ifelse(tax == 2992.61, 1, 0),
BORNCHI_tax500 = BORNCHI*ifelse(tax == 14115.70, 1, 0),
BORNCHI_notax = BORNCHI * ifelse(tax == 0, 1, 0),
AGEATIMM = AGE - (YEAR - YRIMM),
ageheap = ifelse(AGE %% 5 == 0, 1, 0),
twoyearpost = case_when(YRIMM %in% c(1886, 1887) ~ "_post50",
YRIMM %in% c(1901,1902) ~ "post100",
YRIMM %in% c(1904,1905) ~ "post500",
TRUE ~ "_notpost"),
oneyearpost = case_when(YRIMM == 1886 ~ "_post50",
YRIMM == 1901 ~ "post100",
YRIMM == 1904 ~ "post500",
TRUE ~ "_notpost"),
BORNCHI_twoyearpost50 = BORNCHI*ifelse(twoyearpost == "_post50", 1, 0),
BORNCHI_twoyearpost100 = BORNCHI*ifelse(twoyearpost == "post100", 1, 0),
BORNCHI_twoyearpost500 = BORNCHI*ifelse(twoyearpost == "post500", 1, 0))
did_data_japan <- did_data %>% filter(BORNCHI == 1 | BPL == "Japan") %>% filter(YRIMM >= 1890 & YRIMM <= 1907)# & YEAR != 1921)
# # test
didlab <- lm(LABOR ~ factor(YRIMM) + factor(YEAR) + AGE + + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data %>% filter(MALE == 1 & AGE >= 18), #%>% filter(OCC1950 != 290 & OCC1950 != 983),
weights = WEIGHT)
dideng <- lm(SPEAKENG ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data %>% filter(AGE >= 6 & MALE == 1),
weights = WEIGHT)
didread <- lm(CANREAD ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data %>% filter(AGE >= 18 & MALE == 1), weights = WEIGHT)
didwhip <- lm(WHIPPLE ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data %>% filter(MALE == 1 & AGE >= 23 & AGE <= 52), weights = WEIGHT)
didearn <- lm(EARN ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax50 + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data %>% filter(MALE == 1 & AGE >= 18), weights = WEIGHT)
# japan
didjlab <- lm(LABOR ~ factor(YRIMM) + factor(YEAR) + AGE + + BORNCHI + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data_japan %>% filter(MALE == 1 & AGE >= 18), #%>% filter(OCC1950 != 290 & OCC1950 != 983),
weights = WEIGHT)
didjeng <- lm(SPEAKENG ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data_japan %>% filter(AGE >= 6 & MALE == 1),
weights = WEIGHT)
didjread <- lm(CANREAD ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data_japan %>% filter(AGE >= 18 & MALE == 1), weights = WEIGHT)
didjwhip <- lm(WHIPPLE ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data_japan %>% filter(MALE == 1 & AGE >= 23 & AGE <= 52), weights = WEIGHT)
didjearn <- lm(EARN ~ factor(YRIMM) + factor(YEAR) + AGE + BORNCHI + BORNCHI_tax100 + BORNCHI_tax500,
data = did_data_japan %>% filter(MALE == 1 & AGE >= 18), weights = WEIGHT)
did_data_means_chi <- c(weighted.mean(filter(did_data, !is.na(LABOR) & BORNCHI == 1 & MALE == 1 & AGE >= 18)$LABOR,
filter(did_data, !is.na(LABOR) & BORNCHI == 1 & MALE == 1 & AGE >= 18)$WEIGHT),
weighted.mean(filter(did_data, !is.na(CANREAD) & BORNCHI == 1 & MALE == 1 & AGE >= 18)$CANREAD,
filter(did_data, !is.na(CANREAD) & BORNCHI == 1 & MALE == 1 & AGE >= 18)$WEIGHT),
weighted.mean(filter(did_data, !is.na(SPEAKENG) & BORNCHI == 1 & MALE == 1 & AGE >= 6)$SPEAKENG,
filter(did_data, !is.na(SPEAKENG) & BORNCHI == 1 & MALE == 1 & AGE >= 6)$WEIGHT),
weighted.mean(filter(did_data, !is.na(WHIPPLE) & BORNCHI == 1 & MALE == 1 & AGE >= 23 & AGE <= 52)$WHIPPLE,
filter(did_data, !is.na(WHIPPLE) & BORNCHI == 1 & MALE == 1 & AGE >= 23 & AGE <= 52)$WEIGHT),
weighted.mean(filter(did_data, !is.na(EARN) & BORNCHI == 1 & MALE == 1 & AGE >= 18)$EARN,
filter(did_data, !is.na(EARN) & BORNCHI == 1 & MALE == 1 & AGE >= 18)$WEIGHT)
)
# slides: all immig
stargazer(didlab, didread, dideng, didwhip, didearn,
out = glue("{git}/output/slides/selection_all.tex"), float = FALSE,
intercept.bottom = FALSE,
single.row = TRUE,
dep.var.labels = c("$\\mathbb{P}[\\text{Laborer}]$","$\\mathbb{P}[\\text{Literate}]$",
"$\\mathbb{P}[\\text{Speaks English}]$", "Age Heaping", "Earnings"),
keep = c("BORNCHI*"),
covariate.labels = c("$\\hat{\\beta}_{1}$ (Born in China)",
"$\\hat{\\gamma}_{50}^{DD}$ ($C_i \\times$ \\$50 Tax)",
"$\\hat{\\gamma}_{100}^{DD}$ ($C_i \\times$ \\$100 Tax)",
"$\\hat{\\gamma}_{500}^{DD}$ ($C_i \\times$ \\$500 Tax)"),
keep.stat=c("n","adj.rsq"),
table.layout = "d-t-as",
add.lines = list(c("Dep. Var. Mean (Chinese)", formatC(did_data_means_chi, format = "f"))))
#slides: japanese immig
stargazer(didjlab, didjread, didjeng, didjwhip, didjearn,
out = glue("{git}/output/slides/selection_japan.tex"), float = FALSE,
intercept.bottom = FALSE,
single.row = TRUE,
dep.var.labels = c("$\\mathbb{P}[\\text{Laborer}]$","$\\mathbb{P}[\\text{Literate}]$",
"$\\mathbb{P}[\\text{Speaks English}]$", "Age Heaping", "Earnings"),
keep = c("BORNCHI*"),
covariate.labels = c("$\\hat{\\beta}_{1}$ (Born in China)",
"$\\hat{\\gamma}_{100}^{DD}$ ($C_i \\times$ \\$100 Tax)",
"$\\hat{\\gamma}_{500}^{DD}$ ($C_i \\times$ \\$500 Tax)"),
keep.stat=c("n","adj.rsq"),
table.layout = "d-t-as",
add.lines = list(c("Dep. Var. Mean (Chinese)", formatC(did_data_means_chi, format = "f"))))
did_data_means_chi_jap <- c(weighted.mean(filter(did_data_japan, !is.na(LABOR) & BORNCHI == 1 & MALE == 1 & AGE >= 18)$LABOR,
filter(did_data_japan, !is.na(LABOR) & BORNCHI == 1 & MALE == 1 & AGE >= 18)$WEIGHT),
weighted.mean(filter(did_data_japan, !is.na(CANREAD) & BORNCHI == 1 & MALE == 1 & AGE >= 18)$CANREAD,
filter(did_data_japan, !is.na(CANREAD) & BORNCHI == 1 & MALE == 1 & AGE >= 18)$WEIGHT),
weighted.mean(filter(did_data_japan, !is.na(SPEAKENG) & BORNCHI == 1 & MALE == 1 & AGE >= 6)$SPEAKENG,
filter(did_data_japan, !is.na(SPEAKENG) & BORNCHI == 1 & MALE == 1 & AGE >= 6)$WEIGHT),
weighted.mean(filter(did_data_japan, !is.na(WHIPPLE) & BORNCHI == 1 & MALE == 1 & AGE >= 23 & AGE <= 52)$WHIPPLE,
filter(did_data_japan, !is.na(WHIPPLE) & BORNCHI == 1 & MALE == 1 & AGE >= 23 & AGE <= 52)$WEIGHT),
weighted.mean(filter(did_data_japan, !is.na(EARN) & BORNCHI == 1 & MALE == 1 & AGE >= 18)$EARN,
filter(did_data_japan, !is.na(EARN) & BORNCHI == 1 & MALE == 1 & AGE >= 18)$WEIGHT)
)
stargazer(didjlab, didjread, didjeng, didjwhip, didjearn,
out = glue("{git}/output/slides/selection_japan.tex"), float = FALSE,
intercept.bottom = FALSE,
single.row = TRUE,
dep.var.labels = c("$\\mathbb{P}[\\text{Laborer}]$","$\\mathbb{P}[\\text{Literate}]$",
"$\\mathbb{P}[\\text{Speaks English}]$", "Age Heaping", "Earnings"),
keep = c("BORNCHI*"),
covariate.labels = c("$\\hat{\\beta}_{1}$ (Born in China)",
"$\\hat{\\gamma}_{100}^{DD}$ ($C_i \\times$ \\$100 Tax)",
"$\\hat{\\gamma}_{500}^{DD}$ ($C_i \\times$ \\$500 Tax)"),
keep.stat=c("n","adj.rsq"),
table.layout = "d-t-as",
add.lines = list(c("Dep. Var. Mean (Chinese)", formatC(did_data_means_chi_jap, format = "f"))))
0.5/3.3
r = 4000
4000*(1+(0.05/12))^(12*4)
4000*(1+(0.05/12))^(12*5)
4000*(1+(0.20/12))^(12*5)
4000*(1+(0.05/12))^(12)
4000*(1+(0.20/12))^(12)
4000*(1+(0.05/12))^(12*3)
4000*(1+(0.20/12))^(12*3)
(7253-4646)/7253
x <- data.frame(fem = c(rep(0,36),rep(1,36)), ctrack = c(rep(0,20), rep(1,16), rep(0, 24), rep(1,12)))
mean(x$fem)
mean(x$ctrack)
var(x$fem)
var(x$ctrack)
20*0.5*0.39-16*0.5*(1-0.39)-24*0.5*0.39+12*0.5*(1-0.39)
-2/72
cov(x$fem, x$ctrack)
xbar = mean(x$fem)
ybar = mean(x$ctrack)
20*0.5*ybar-16*0.5*(1-ybar)-24*0.5*ybar+12*0.5*(1-ybar)
-2/71
